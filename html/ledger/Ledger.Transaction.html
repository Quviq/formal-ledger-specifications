<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Transaction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Transactions}
\label{sec:transactions}

</a><a id="50" class="Markup">\begin{code}[hide]</a>
<a id="69" class="Symbol">{-#</a> <a id="73" class="Keyword">OPTIONS</a> <a id="81" class="Pragma">--safe</a> <a id="88" class="Symbol">#-}</a>
<a id="92" class="Comment">--------------------------------------------------------------------------------</a>
<a id="173" class="Comment">-- NOTE: Everything in this module is part of TransactionStructure</a>
<a id="240" class="Comment">--------------------------------------------------------------------------------</a>
<a id="321" class="Keyword">module</a> <a id="328" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a> <a id="347" class="Keyword">where</a>

<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a>
<a id="433" class="Keyword">import</a> <a id="440" href="Ledger.PParams.html" class="Module">Ledger.PParams</a>
<a id="455" class="Keyword">import</a> <a id="462" href="Ledger.Script.html" class="Module">Ledger.Script</a>
<a id="476" class="Keyword">import</a> <a id="483" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a>
<a id="508" class="Keyword">import</a> <a id="515" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="535" class="Symbol">as</a> <a id="538" class="Module">TA</a>

<a id="542" class="Keyword">record</a> <a id="TransactionStructure"></a><a id="549" href="Ledger.Transaction.html#549" class="Record">TransactionStructure</a> <a id="570" class="Symbol">:</a> <a id="572" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="577" class="Keyword">where</a>
  <a id="585" class="Keyword">field</a>
<a id="591" class="Markup">\end{code}</a><a id="601" class="Background">

Transactions are defined in Figure~\ref{fig:defs:utxo-shelley}. A
transaction is made up of a transaction body, a collection of
witnesses and some optional auxiliary data. Some key ingredients in
the transaction body are:

\begin{itemize}
  \item A set of transaction inputs, each of which identifies an output from a previous transaction.
    A transaction input consists of a transaction id and an index to uniquely identify the output.
  \item An indexed collection of transaction outputs.
    The $\TxOut$ type is an address paired with a coin value.
  \item A transaction fee. This value will be added to the fee pot.
  \item The size and the hash of the serialized form of the transaction that was included in the block.
\end{itemize}

\begin{figure*}[h]
\emph{Abstract types}
\AgdaTarget{Ix, TxId, Epoch, AuxiliaryData}
</a><a id="1430" class="Markup">\begin{code}</a>
        <a id="TransactionStructure.Ix"></a><a id="1451" href="Ledger.Transaction.html#1451" class="Field">Ix</a> <a id="TransactionStructure.TxId"></a><a id="1454" href="Ledger.Transaction.html#1454" class="Field">TxId</a> <a id="TransactionStructure.AuxiliaryData"></a><a id="1459" href="Ledger.Transaction.html#1459" class="Field">AuxiliaryData</a> <a id="1473" class="Symbol">:</a> <a id="1475" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1479" class="Markup">\end{code}</a><a id="1489" class="Background">
</a><a id="1490" class="Markup">\begin{code}[hide]</a>
        <a id="TransactionStructure.epochStructure"></a><a id="1517" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a>                      <a id="1553" class="Symbol">:</a> <a id="1555" href="Ledger.Epoch.html#526" class="Record">EpochStructure</a>
        <a id="TransactionStructure.globalConstants"></a><a id="1578" href="Ledger.Transaction.html#1578" class="Field">globalConstants</a>                     <a id="1614" class="Symbol">:</a> <a id="1616" href="Ledger.Epoch.html#300" class="Record">GlobalConstants</a>

  <a id="1635" class="Keyword">open</a> <a id="1640" href="Ledger.Epoch.html#526" class="Module">EpochStructure</a> <a id="1655" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a> <a id="1670" class="Keyword">public</a>
  <a id="1679" class="Keyword">open</a> <a id="1684" href="Ledger.Epoch.html#300" class="Module">GlobalConstants</a> <a id="1700" href="Ledger.Transaction.html#1578" class="Field">globalConstants</a> <a id="1716" class="Keyword">public</a>
  <a id="1725" class="Keyword">field</a> <a id="TransactionStructure.crypto"></a><a id="1731" href="Ledger.Transaction.html#1731" class="Field">crypto</a>                              <a id="1767" class="Symbol">:</a> <a id="1769" href="Ledger.Crypto.html#1628" class="Record">Crypto</a>
        <a id="TransactionStructure.adHashingScheme"></a><a id="1784" href="Ledger.Transaction.html#1784" class="Field">adHashingScheme</a>                     <a id="1820" class="Symbol">:</a> <a id="1822" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="1836" href="Ledger.Transaction.html#1459" class="Field">AuxiliaryData</a>
        <a id="TransactionStructure.ppHashingScheme"></a><a id="1858" href="Ledger.Transaction.html#1858" class="Field">ppHashingScheme</a>                     <a id="1894" class="Symbol">:</a> <a id="1896" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="1910" class="Symbol">(</a><a id="1911" href="Ledger.PParams.html#1053" class="Record">Ledger.PParams.PParams</a> <a id="1934" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a><a id="1948" class="Symbol">)</a>
        <a id="TransactionStructure.ppUpd"></a><a id="1958" href="Ledger.Transaction.html#1958" class="Field">ppUpd</a>                               <a id="1994" class="Symbol">:</a> <a id="1996" href="Ledger.PParams.html#5164" class="Record">Ledger.PParams.PParamsDiff</a> <a id="2023" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a>
        <a id="TransactionStructure.txidBytes"></a><a id="2046" href="Ledger.Transaction.html#2046" class="Field">txidBytes</a>                           <a id="2082" class="Symbol">:</a> <a id="2084" href="Ledger.Transaction.html#1454" class="Field">TxId</a> <a id="2089" class="Symbol">→</a> <a id="2091" href="Ledger.Crypto.html#938" class="Function">Crypto.Ser</a> <a id="2102" href="Ledger.Transaction.html#1731" class="Field">crypto</a>
        <a id="TransactionStructure.networkId"></a><a id="2117" href="Ledger.Transaction.html#2117" class="Field">networkId</a>                           <a id="2153" class="Symbol">:</a> <a id="2155" href="Ledger.Epoch.html#337" class="Function">Network</a>
        <a id="2171" class="Keyword">instance</a> <a id="TransactionStructure.DecEq-TxId"></a><a id="2180" href="Ledger.Transaction.html#2180" class="Field">DecEq-TxId</a>  <a id="2192" class="Symbol">:</a> <a id="2194" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="2200" href="Ledger.Transaction.html#1454" class="Field">TxId</a>
                 <a id="TransactionStructure.DecEq-Ix"></a><a id="2222" href="Ledger.Transaction.html#2222" class="Field">DecEq-Ix</a>    <a id="2234" class="Symbol">:</a> <a id="2236" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="2242" href="Ledger.Transaction.html#1451" class="Field">Ix</a>
                 <a id="TransactionStructure.DecEq-Netw"></a><a id="2262" href="Ledger.Transaction.html#2262" class="Field">DecEq-Netw</a>  <a id="2274" class="Symbol">:</a> <a id="2276" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="2282" href="Ledger.Epoch.html#337" class="Function">Network</a>
                 <a id="TransactionStructure.DecEq-UpdT"></a><a id="2307" href="Ledger.Transaction.html#2307" class="Field">DecEq-UpdT</a>  <a id="2319" class="Symbol">:</a> <a id="2321" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="2327" class="Symbol">(</a><a id="2328" href="Ledger.PParams.html#5197" class="Field">Ledger.PParams.PParamsDiff.UpdateT</a> <a id="2363" href="Ledger.Transaction.html#1958" class="Field">ppUpd</a><a id="2368" class="Symbol">)</a>

  <a id="2373" class="Keyword">open</a> <a id="2378" href="Ledger.Crypto.html#1628" class="Module">Crypto</a> <a id="2385" href="Ledger.Transaction.html#1731" class="Field">crypto</a> <a id="2392" class="Keyword">public</a>
  <a id="2401" class="Keyword">open</a> <a id="2406" href="Ledger.TokenAlgebra.html" class="Module">TA</a> <a id="2409" href="Ledger.Crypto.html#1750" class="Function">ScriptHash</a>
  <a id="2422" class="Keyword">open</a> <a id="2427" href="Ledger.Crypto.html#190" class="Module">isHashableSet</a> <a id="2441" href="Ledger.Transaction.html#1784" class="Field">adHashingScheme</a> <a id="2457" class="Keyword">renaming</a> <a id="2466" class="Symbol">(</a><a id="2467" href="Ledger.Crypto.html#235" class="Field">THash</a> <a id="2473" class="Symbol">to</a> <a id="2476" class="Field">ADHash</a><a id="2482" class="Symbol">)</a> <a id="2484" class="Keyword">public</a>

  <a id="2494" class="Keyword">field</a>  <a id="TransactionStructure.ss"></a><a id="2501" href="Ledger.Transaction.html#2501" class="Field">ss</a>            <a id="2515" class="Symbol">:</a> <a id="2517" href="Ledger.Script.html#1232" class="Record">Ledger.Script.ScriptStructure</a> <a id="2547" href="Ledger.Crypto.html#1812" class="Function">KeyHash</a> <a id="2555" href="Ledger.Crypto.html#1750" class="Function">ScriptHash</a> <a id="2566" href="Ledger.Epoch.html#608" class="Function">Slot</a>
         <a id="TransactionStructure.tokenAlgebra"></a><a id="2580" href="Ledger.Transaction.html#2580" class="Field">tokenAlgebra</a>  <a id="2594" class="Symbol">:</a> <a id="2596" href="Ledger.TokenAlgebra.html#499" class="Record">TokenAlgebra</a>

  <a id="2612" class="Keyword">open</a> <a id="2617" href="Ledger.TokenAlgebra.html#499" class="Module">TokenAlgebra</a> <a id="2630" href="Ledger.Transaction.html#2580" class="Field">tokenAlgebra</a> <a id="2643" class="Keyword">public</a>

  <a id="2653" class="Keyword">open</a> <a id="2658" href="Ledger.Script.html#1232" class="Module">Ledger.Script.ScriptStructure</a> <a id="2688" href="Ledger.Transaction.html#2501" class="Field">ss</a> <a id="2691" class="Keyword">public</a>

  <a id="2701" class="Keyword">open</a> <a id="2706" class="Keyword">import</a> <a id="2713" href="Ledger.PParams.html" class="Module">Ledger.PParams</a> <a id="2728" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a>

  <a id="2746" class="Keyword">open</a> <a id="2751" href="Ledger.PParams.html#5164" class="Module">PParamsDiff</a> <a id="2763" href="Ledger.Transaction.html#1958" class="Field">ppUpd</a> <a id="2769" class="Keyword">renaming</a> <a id="2778" class="Symbol">(</a><a id="2779" href="Ledger.PParams.html#5197" class="Field">UpdateT</a> <a id="2787" class="Symbol">to</a> <a id="2790" class="Field">PParamsUpdate</a><a id="2803" class="Symbol">)</a> <a id="2805" class="Keyword">public</a>
  <a id="2814" class="Comment">-- TODO: figure out what to do with the hash</a>
  <a id="2861" class="Keyword">open</a> <a id="2866" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a> <a id="2891" href="Ledger.Transaction.html#1454" class="Field">TxId</a> <a id="2896" href="Ledger.Epoch.html#337" class="Function">Network</a> <a id="2904" href="Ledger.Transaction.html#2476" class="Function">ADHash</a> <a id="2911" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a> <a id="2926" href="Ledger.Transaction.html#1958" class="Field">ppUpd</a> <a id="2932" href="Ledger.Transaction.html#1858" class="Field">ppHashingScheme</a> <a id="2948" href="Ledger.Transaction.html#1731" class="Field">crypto</a> <a id="2955" class="Keyword">hiding</a> <a id="2962" class="Symbol">(</a><a id="2963" href="Ledger.GovernanceActions.html#9041" class="InductiveConstructor">yes</a><a id="2966" class="Symbol">;</a> <a id="2968" href="Ledger.GovernanceActions.html#9059" class="InductiveConstructor">no</a><a id="2970" class="Symbol">)</a> <a id="2972" class="Keyword">public</a>

  <a id="2982" class="Keyword">open</a> <a id="2987" class="Keyword">import</a> <a id="2994" href="Ledger.Address.html" class="Module">Ledger.Address</a> <a id="3009" href="Ledger.Epoch.html#337" class="Function">Network</a> <a id="3017" href="Ledger.Crypto.html#1812" class="Function">KeyHash</a> <a id="3025" href="Ledger.Crypto.html#1750" class="Function">ScriptHash</a> <a id="3036" class="Keyword">public</a>
  <a id="3045" class="Keyword">open</a> <a id="3050" class="Keyword">import</a> <a id="3057" href="Ledger.Deleg.html" class="Module">Ledger.Deleg</a> <a id="3070" href="Ledger.Transaction.html#1731" class="Field">crypto</a> <a id="3077" href="Ledger.Transaction.html#1454" class="Field">TxId</a> <a id="3082" href="Ledger.Epoch.html#337" class="Function">Network</a> <a id="3090" href="Ledger.Transaction.html#2476" class="Function">ADHash</a> <a id="3097" href="Ledger.Transaction.html#1517" class="Field">epochStructure</a> <a id="3112" href="Ledger.Transaction.html#1958" class="Field">ppUpd</a> <a id="3118" href="Ledger.Transaction.html#1858" class="Field">ppHashingScheme</a> <a id="3134" class="Keyword">public</a>
<a id="3141" class="Markup">\end{code}</a><a id="3151" class="Background">
\emph{Derived types}
\AgdaTarget{TxIn, TxOut, UTxO, Wdrl}
</a><a id="3210" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.TxIn"></a><a id="3225" href="Ledger.Transaction.html#3225" class="Function">TxIn</a>   <a id="3232" class="Symbol">=</a> <a id="3234" href="Ledger.Transaction.html#1454" class="Field">TxId</a> <a id="3239" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3241" href="Ledger.Transaction.html#1451" class="Field">Ix</a>
  <a id="TransactionStructure.TxOut"></a><a id="3246" href="Ledger.Transaction.html#3246" class="Function">TxOut</a>  <a id="3253" class="Symbol">=</a> <a id="3255" href="Ledger.Address.html#1317" class="Function">Addr</a> <a id="3260" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3262" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="TransactionStructure.UTxO"></a><a id="3270" href="Ledger.Transaction.html#3270" class="Function">UTxO</a>   <a id="3277" class="Symbol">=</a> <a id="3279" href="Ledger.Transaction.html#3225" class="Function">TxIn</a> <a id="3284" href="Ledger.Prelude.html#2585" class="Function Operator">⇀</a> <a id="3286" href="Ledger.Transaction.html#3246" class="Function">TxOut</a>
  <a id="TransactionStructure.Wdrl"></a><a id="3294" href="Ledger.Transaction.html#3294" class="Function">Wdrl</a>   <a id="3301" class="Symbol">=</a> <a id="3303" href="Ledger.Address.html#1243" class="Record">RwdAddr</a> <a id="3311" href="Ledger.Prelude.html#2585" class="Function Operator">⇀</a> <a id="3313" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

  <a id="TransactionStructure.ProposedPPUpdates"></a><a id="3321" href="Ledger.Transaction.html#3321" class="Function">ProposedPPUpdates</a>  <a id="3340" class="Symbol">=</a> <a id="3342" href="Ledger.Crypto.html#1812" class="Function">KeyHash</a> <a id="3350" href="Ledger.Prelude.html#2585" class="Function Operator">⇀</a> <a id="3352" href="Ledger.Transaction.html#2790" class="Function">PParamsUpdate</a>
  <a id="TransactionStructure.Update"></a><a id="3368" href="Ledger.Transaction.html#3368" class="Function">Update</a>             <a id="3387" class="Symbol">=</a> <a id="3389" href="Ledger.Transaction.html#3321" class="Function">ProposedPPUpdates</a> <a id="3407" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3409" href="Ledger.Epoch.html#593" class="Function">Epoch</a>
<a id="3415" class="Markup">\end{code}</a><a id="3425" class="Background">
\emph{Transaction types}
\AgdaTarget{TxBody, txins, txouts, txfee, txvldt, txwdrls, txup, txADhash, txsize, txid, TxWitnesses, vkSigs, scripts, Tx, body, wits, txAD}
\begin{AgdaSuppressSpace}
</a><a id="3618" class="Markup">\begin{code}</a>
  <a id="3633" class="Keyword">record</a> <a id="TransactionStructure.TxBody"></a><a id="3640" href="Ledger.Transaction.html#3640" class="Record">TxBody</a> <a id="3647" class="Symbol">:</a> <a id="3649" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="3653" class="Keyword">where</a>
    <a id="3663" class="Keyword">field</a> <a id="3669" href="Ledger.Transaction.html#3669" class="Field">txins</a>       <a id="3681" class="Symbol">:</a> <a id="3683" href="Ledger.Prelude.html#1583" class="Function Operator">ℙ</a> <a id="3685" href="Ledger.Transaction.html#3225" class="Function">TxIn</a>
          <a id="3700" href="Ledger.Transaction.html#3700" class="Field">txouts</a>      <a id="3712" class="Symbol">:</a> <a id="3714" href="Ledger.Transaction.html#1451" class="Field">Ix</a> <a id="3717" href="Ledger.Prelude.html#2585" class="Function Operator">⇀</a> <a id="3719" href="Ledger.Transaction.html#3246" class="Function">TxOut</a>
          <a id="3735" href="Ledger.Transaction.html#3735" class="Field">txfee</a>       <a id="3747" class="Symbol">:</a> <a id="3749" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
          <a id="3764" href="Ledger.Transaction.html#3764" class="Field">mint</a>        <a id="3776" class="Symbol">:</a> <a id="3778" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
          <a id="3794" href="Ledger.Transaction.html#3794" class="Field">txvldt</a>      <a id="3806" class="Symbol">:</a> <a id="3808" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3814" href="Ledger.Epoch.html#608" class="Function">Slot</a> <a id="3819" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3821" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3827" href="Ledger.Epoch.html#608" class="Function">Slot</a>
          <a id="3842" href="Ledger.Transaction.html#3842" class="Field">txcerts</a>     <a id="3854" class="Symbol">:</a> <a id="3856" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3861" href="Ledger.Deleg.html#832" class="Datatype">DCert</a>
          <a id="3877" href="Ledger.Transaction.html#3877" class="Field">txwdrls</a>     <a id="3889" class="Symbol">:</a> <a id="3891" href="Ledger.Transaction.html#3294" class="Function">Wdrl</a>
          <a id="3906" href="Ledger.Transaction.html#3906" class="Field">txvote</a>      <a id="3918" class="Symbol">:</a> <a id="3920" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3925" href="Ledger.GovernanceActions.html#9101" class="Record">GovVote</a>
          <a id="3943" href="Ledger.Transaction.html#3943" class="Field">txprop</a>      <a id="3955" class="Symbol">:</a> <a id="3957" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3962" href="Ledger.GovernanceActions.html#9288" class="Record">GovProposal</a>
          <a id="3984" href="Ledger.Transaction.html#3984" class="Field">txdonation</a>  <a id="3996" class="Symbol">:</a> <a id="3998" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
          <a id="4010" href="Ledger.Transaction.html#4010" class="Field">txup</a>        <a id="4022" class="Symbol">:</a> <a id="4024" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4030" href="Ledger.Transaction.html#3368" class="Function">Update</a>
          <a id="4047" href="Ledger.Transaction.html#4047" class="Field">txADhash</a>    <a id="4059" class="Symbol">:</a> <a id="4061" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4067" href="Ledger.Transaction.html#2476" class="Function">ADHash</a>
          <a id="4084" href="Ledger.Transaction.html#4084" class="Field">netwrk</a>      <a id="4096" class="Symbol">:</a> <a id="4098" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4104" href="Ledger.Epoch.html#337" class="Function">Network</a>
          <a id="4122" href="Ledger.Transaction.html#4122" class="Field">txsize</a>      <a id="4134" class="Symbol">:</a> <a id="4136" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
          <a id="4148" href="Ledger.Transaction.html#4148" class="Field">txid</a>        <a id="4160" class="Symbol">:</a> <a id="4162" href="Ledger.Transaction.html#1454" class="Field">TxId</a>

  <a id="4170" class="Keyword">record</a> <a id="TransactionStructure.TxWitnesses"></a><a id="4177" href="Ledger.Transaction.html#4177" class="Record">TxWitnesses</a> <a id="4189" class="Symbol">:</a> <a id="4191" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="4195" class="Keyword">where</a>
    <a id="4205" class="Keyword">field</a> <a id="4211" href="Ledger.Transaction.html#4211" class="Field">vkSigs</a>   <a id="4220" class="Symbol">:</a> <a id="4222" href="Ledger.Crypto.html#929" class="Function">VKey</a> <a id="4227" href="Ledger.Prelude.html#2585" class="Function Operator">⇀</a> <a id="4229" href="Ledger.Crypto.html#934" class="Function">Sig</a>
          <a id="4243" href="Ledger.Transaction.html#4243" class="Field">scripts</a>  <a id="4252" class="Symbol">:</a> <a id="4254" href="Ledger.Prelude.html#1583" class="Function Operator">ℙ</a> <a id="4256" href="Ledger.Script.html#1510" class="Function">Script</a>

  <a id="4266" class="Keyword">record</a> <a id="TransactionStructure.Tx"></a><a id="4273" href="Ledger.Transaction.html#4273" class="Record">Tx</a> <a id="4276" class="Symbol">:</a> <a id="4278" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="4282" class="Keyword">where</a>
    <a id="4292" class="Keyword">field</a> <a id="4298" href="Ledger.Transaction.html#4298" class="Field">body</a>  <a id="4304" class="Symbol">:</a> <a id="4306" href="Ledger.Transaction.html#3640" class="Record">TxBody</a>
          <a id="4323" href="Ledger.Transaction.html#4323" class="Field">wits</a>  <a id="4329" class="Symbol">:</a> <a id="4331" href="Ledger.Transaction.html#4177" class="Record">TxWitnesses</a>
          <a id="4353" href="Ledger.Transaction.html#4353" class="Field">txAD</a>  <a id="4359" class="Symbol">:</a> <a id="4361" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4367" href="Ledger.Transaction.html#1459" class="Field">AuxiliaryData</a>
<a id="4381" class="Markup">\end{code}</a><a id="4391" class="Background">
\end{AgdaSuppressSpace}
\caption{Definitions used in the UTxO transition system}
\label{fig:defs:utxo-shelley}
\end{figure*}

\begin{figure*}[h]
</a><a id="4537" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.getValue"></a><a id="4552" href="Ledger.Transaction.html#4552" class="Function">getValue</a> <a id="4561" class="Symbol">:</a> <a id="4563" href="Ledger.Transaction.html#3246" class="Function">TxOut</a> <a id="4569" class="Symbol">→</a> <a id="4571" href="Ledger.TokenAlgebra.html#781" class="Function">Value</a>
  <a id="4579" href="Ledger.Transaction.html#4552" class="Function">getValue</a> <a id="4588" class="Symbol">(_</a> <a id="4591" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4593" href="Ledger.Transaction.html#4593" class="Bound">v</a><a id="4594" class="Symbol">)</a> <a id="4596" class="Symbol">=</a> <a id="4598" href="Ledger.Transaction.html#4593" class="Bound">v</a>

  <a id="TransactionStructure.txinsVKey"></a><a id="4603" href="Ledger.Transaction.html#4603" class="Function">txinsVKey</a> <a id="4613" class="Symbol">:</a> <a id="4615" href="Ledger.Prelude.html#1583" class="Function Operator">ℙ</a> <a id="4617" href="Ledger.Transaction.html#3225" class="Function">TxIn</a> <a id="4622" class="Symbol">→</a> <a id="4624" href="Ledger.Transaction.html#3270" class="Function">UTxO</a> <a id="4629" class="Symbol">→</a> <a id="4631" href="Ledger.Prelude.html#1583" class="Function Operator">ℙ</a> <a id="4633" href="Ledger.Transaction.html#3225" class="Function">TxIn</a>
  <a id="4640" href="Ledger.Transaction.html#4603" class="Function">txinsVKey</a> <a id="4650" href="Ledger.Transaction.html#4650" class="Bound">txins</a> <a id="4656" href="Ledger.Transaction.html#4656" class="Bound">utxo</a> <a id="4661" class="Symbol">=</a> <a id="4663" href="Ledger.Transaction.html#4650" class="Bound">txins</a> <a id="4669" href="Axiom.Set.html#9126" class="Function Operator">∩</a> <a id="4671" href="Axiom.Set.Rel.html#1551" class="Function">dom</a> <a id="4675" class="Symbol">((</a><a id="4677" href="Ledger.Transaction.html#4656" class="Bound">utxo</a> <a id="4682" href="Axiom.Set.Map.html#7147" class="Function Operator">↾&#39;</a> <a id="4685" href="Ledger.Prelude.html#1679" class="Function">to-sp</a> <a id="4691" class="Symbol">(</a><a id="4692" href="Ledger.Address.html#2396" class="Function">isVKeyAddr?</a> <a id="4704" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4706" href="Data.Product.Base.html#608" class="Field">proj₁</a><a id="4711" class="Symbol">))</a> <a id="4714" href="Axiom.Set.Map.html#2261" class="Function Operator">ˢ</a><a id="4715" class="Symbol">)</a>
<a id="4717" class="Markup">\end{code}</a><a id="4727" class="Background">
\end{figure*}
</a><a id="4742" class="Markup">\begin{code}[hide]</a>
  <a id="4763" class="Keyword">instance</a>
    <a id="TransactionStructure.HasCoin-TxOut"></a><a id="4776" href="Ledger.Transaction.html#4776" class="Function">HasCoin-TxOut</a> <a id="4790" class="Symbol">:</a> <a id="4792" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="4800" href="Ledger.Transaction.html#3246" class="Function">TxOut</a>
    <a id="4810" href="Ledger.Transaction.html#4776" class="Function">HasCoin-TxOut</a> <a id="4824" class="Symbol">.</a><a id="4825" href="Ledger.Interface.HasCoin.html#170" class="Field">getCoin</a> <a id="4833" class="Symbol">=</a> <a id="4835" href="Ledger.TokenAlgebra.html#924" class="Function">coin</a> <a id="4840" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="4842" href="Data.Product.Base.html#622" class="Field">proj₂</a>
<a id="4848" class="Markup">\end{code}</a><a id="4858" class="Background">
</a></pre></body></html>